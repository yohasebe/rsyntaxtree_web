$(function(){function i(e,t){u&&clearInterval(u),$("#alert").empty();var a=$("<span class='text text-"+t+"'>\u25cf</span> <span style='font-size: 0.9em; font-family: Menlo, Monaco, Consolas, monospace; font-weight:regular; color:white;'>"+e+"</span>");$("#alert").append(a),u=setTimeout(function(){$("#alert").html(m)},15e3)}function a(e){var t="data="+encodeURIComponent(e);return t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t+"&leafstyle="+$("select[name=leafstyle]").val())+"&fontstyle="+$("select[name=fontstyle]").val())+"&fontsize="+$("select[name=fontsize]").val())+"&vheight="+$("select[name=vheight]").val())+"&polyline="+$("input[name=polyline]:checked").val())+"&color="+$("select[name=color]").val())+"&linewidth="+$("select[name=linewidth]").val())+"&symmetrize="+$("input[name=symmetrize]:checked").val())+"&transparent="+$("input[name=transparent]:checked").val())+"&hide_default_connectors="+$("input[name=hide_default_connectors]:checked").val()}function n(){$("button.draw").attr("disabled","disabled"),$("#result").resizable("destroy"),i("Please wait ...","warning")}function l(){$("button.draw").removeAttr("disabled"),$("#result").resizable({handles:"se",grid:[1e7,1]}).on("resize",function(){})}function o(e,t){n(),"svg"==t?$.ajax({url:p+"/draw_svg",type:"POST",dataType:"json",data:a(e)}).done(function(e){if("success"===e.status){var t=e.svg;$("#result").empty();var a="data:image/svg+xml;base64, "+t,n=new Image;n.src=a;var o=$(n).attr("id","tree_image"),s=$("<a href='"+a+"' data-lightbox='syntree'>");s.append(o),$("#result").append(s),l(),i("Syntree generated successfully","success"),$("body, html").animate({scrollTop:top},500)}else{var r=e.message;l(),i(r,"warning"),$("body, html").animate({scrollTop:top},500)}}).fail(function(){l(),i("Error: Something unexpected occurred","danger"),$("body, html").animate({scrollTop:top},500)}):$.ajax({url:p+"/draw_png",type:"POST",dataType:"json",data:a(e)}).done(function(e){if("success"===e.status){var t=e.png;$("#result").empty();var a="data:image/png;base64, "+t,n=new Image;n.src=a;var o=$(n).attr("id","tree_image"),s=$("<a href='"+a+"' data-lightbox='syntree'>");s.append(o),$("#result").append(s),l(),i("Syntree generated successfully","success"),$("body, html").animate({scrollTop:top},500)}else{var r=e.message;l(),i(r,"danger"),$("body, html").animate({scrollTop:top},500)}}).fail(function(){l(),i("Error: Something unexpected occurred","danger"),$("body, html").animate({scrollTop:top},500)})}function s(e){return e=e.replace(/\&/g,"-AMP-").replace(/\%/g,"-PERCENT-").replace(/\'/g,"-PRIME-").replace(/\;/g,"-SCOLON-").replace(/\</g,"-OABRACKET-").replace(/\>/g,"-CABRACKET-"),e=$("<div/>").text(e).html()}function r(e,t){$("<form/>",{action:p+"/download_"+t,method:"POST"}).append($("<input/>",{type:"hidden",name:"data",value:e})).append($("<input/>",{type:"hidden",name:"format",value:$("select[name=format]").val()})).append($("<input/>",{type:"hidden",name:"leafstyle",value:$("select[name=leafstyle]").val()})).append($("<input/>",{type:"hidden",name:"fontstyle",value:$("select[name=fontstyle]").val()})).append($("<input/>",{type:"hidden",name:"fontsize",value:$("select[name=fontsize]").val()})).append($("<input/>",{type:"hidden",name:"vheight",value:$("select[name=vheight]").val()})).append($("<input/>",{type:"hidden",name:"polyline",value:$("input[name=polyline]:checked").val()})).append($("<input/>",{type:"hidden",name:"color",value:$("select[name=color]").val()})).append($("<input/>",{type:"hidden",name:"linewidth",value:$("select[name=linewidth]").val()})).append($("<input/>",{type:"hidden",name:"symmetrize",value:$("input[name=symmetrize]:checked").val()})).append($("<input/>",{type:"hidden",name:"hide_default_connectors",value:$("input[name=hide_default_connectors]:checked").val()})).append($("<input/>",{type:"hidden",name:"transparent",value:$("input[name=transparent]:checked").val()})).appendTo(document.body).submit()}function e(e){d.session.insert(d.getCursorPosition(),e),d.focus()}function t(e,t){var a='<div class="ipa-category-container">';for(var n in t)if(t.hasOwnProperty(n)){var o=t[n];a+='<div class="ipa-subcategory">',a+='<h6 class="ipa-subcategory-title">'+n+"</h6>",a+='<div class="ipa-button-group">',o.forEach(function(e){a+='<button type="button" class="btn btn-sm btn-outline-secondary ipa-char-btn" data-char="'+e+'">'+e+"</button>"}),a+="</div></div>"}return a+="</div>"}var c=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase());define("ace/mode/custom",[],function(e,t){var a=require("ace/lib/oop"),n=require("ace/mode/text").Mode,o=require("ace/mode/custom_highlight_rules").CustomHighlightRules,s=require("ace/mode/behaviour/cstyle").CstyleBehaviour,r=function(){this.HighlightRules=o,this.$behaviour=new s};a.inherits(r,n),function(){}.call(r.prototype),t.Mode=r}),define("ace/mode/custom_highlight_rules",[],function(e,t){var a=e("ace/lib/oop"),n=e("ace/mode/text_highlight_rules").TextHighlightRules,o=function(){this.$rules={start:[{token:["text","string","text"],regex:/(\[)(\S+)(\])/,next:"start"},{token:["text","keyword"],regex:/(\[)(\S+)/,next:"start"},{token:"text",regex:/\]/,next:"start"},{defaultToken:"string",next:"start"}]},this.normalizeRules()};a.inherits(o,n),t.CustomHighlightRules=o});var d=ace.edit("editor");d.setTheme("ace/theme/textmate"),d.setOption("highlightActiveLine",!1),d.session.setMode("ace/mode/custom"),d.session.setOption("wrap",!0),d.session.setOption("tabSize",2),d.renderer.setOption("fontSize",14),d.renderer.setOption("showPrintMargin",!1),d.setAutoScrollEditorIntoView(!0),c?(d.renderer.setOption("showGutter",!1),d.setOption("showLineNumbers",!1)):(d.renderer.setOption("showGutter",!0),d.setOption("showLineNumbers",!0)),l();var u,p=$("#top").data("subdir"),m=$("<span class='text text-info'>\u25cf</span> <span class='alertmessage'></span>");$("#draw_png").click(function(){$("#alert").empty();var t=d.getValue();t=s(t),$.ajax({type:"POST",dataType:"json",url:p+"/check",data:a(t)}).done(function(e){"failure"===e.status?(i(e.message,"danger"),$("body, html").animate({scrollTop:top},500)):($("input[name=transparent]:checked").val()?$("#result").css("background-color","transparent"):$("#result").css("background-color","white"),o(t,"png"))}).fail(function(){l(),i("Error: Unexpected type of input","danger")})}),$("#draw_svg").click(function(){$("#alert").empty();var t=d.getValue();t=s(t),$.ajax({type:"POST",dataType:"json",url:p+"/check",data:a(t)}).done(function(e){"failure"===e.status?(i(e.message,"danger"),$("body, html").animate({scrollTop:top},500)):($("input[name=transparent]:checked").val()?$("#result").css("background-color","transparent"):$("#result").css("background-color","white"),o(t,"svg"))}).fail(function(){l(),i("Error: Something unexpected occurred","danger"),$("body, html").animate({scrollTop:top},500)})}),$("#download_png").click(function(){$("#alert").empty();var t=d.getValue();t=s(t),$.ajax({type:"POST",dataType:"json",url:p+"/check_plus",data:a(t)}).done(function(e){"failure"===e.status?(i(e.message,"warning"),$("body, html").animate({scrollTop:top},500)):(i("Syntree generated successfully","success"),r(t,"png"))}).fail(function(){l(),i("Error: Something unexpected occurred","danger"),$("body, html").animate({scrollTop:top},500)})}),$("#download_svg").click(function(){$("#alert").empty();var t=d.getValue();t=s(t),$.ajax({type:"POST",dataType:"json",url:p+"/check_plus",data:a(t)}).done(function(e){"failure"===e.status?(i(e.message,"warning"),$("body, html").animate({scrollTop:top},500)):(i("Syntree generated successfully","success"),r(t,"svg"))}).fail(function(){l(),i("Error: Something unexpected occurrred","danger"),$("body, html").animate({scrollTop:top},500)})}),$("#download_pdf").click(function(){$("#alert").empty();var t=d.getValue();t=s(t),$.ajax({type:"POST",dataType:"json",url:p+"/check_plus",data:a(t)}).done(function(e){"failure"===e.status?(i(e.message,"warning"),$("body, html").animate({scrollTop:top},500)):(i("Syntree generated successfully","success"),r(t,"pdf"))}).fail(function(){l(),i("Error: Something unexpected occurrred","danger"),$("body, html").animate({scrollTop:top},500)})}),$("#check").click(function(){var e=d.getValue();$.ajax({type:"POST",dataType:"json",url:p+"/check",data:"data="+s(e)}).done(function(e){"failure"===e.status?i(e.message,"warning"):i("Brackets are balanced","success")}).fail(function(){l(),i("Error: Something unexpected occurred","danger")})}),$("#clear").click(function(){d.setValue("");$("#alert").empty()}),d.focus(),$("#editor").resizable({handles:"se",grid:[1e7,1]}).on("resize",function(){d.resize()}),$("#result").resizable({handles:"se",grid:[1e7,1]}).on("resize",function(){}),$(document).on("scroll",function(){100<$(window).scrollTop()?$(".ctrl-wrapper.scroll-top").addClass("show"):$(".ctrl-wrapper.scroll-top").removeClass("show")}),$("#to-top").click(function(){$("html, body").animate({scrollTop:$("body").offset().top},40)}),$(document).click(function(e){var t=$(e.target);!0!==$(".navbar-collapse").hasClass("show")||t.hasClass("navbar-toggler")||$(".navbar-toggler").click()}),$(".next").click(function(){return $(".carousel").carousel("next"),!1}),$(".prev").click(function(){return $(".carousel").carousel("prev"),!1}),$(".carousel").carousel({interval:12e3});var h=$(".carousel-inner .carousel-item"),g=Math.floor(Math.random()*h.length);g=Math.floor(Math.random()*h.length);h.removeClass("active").eq(g).addClass("active"),h.eq(g).addClass("active"),d.setBehavioursEnabled(!1),$("#auto-bracket").click(function(){$("#auto-bracket").prop("checked")?d.setBehavioursEnabled(!0):d.setBehavioursEnabled(!1)}),lightbox.option({resizeDuration:200}),$("#insert-backslash").click(function(){e("\\")}),$("#insert-bar").click(function(){e("|")}),$("#toggle-ipa-keyboard").click(function(){$("#ipa-keyboard-panel").slideToggle()});var f={vowels:{Close:["i","y","\u0268","\u0289","\u026f","u"],"Near-close":["\u026a","\u028f","\u028a"],"Close-mid":["e","\xf8","\u0258","\u0275","\u0264","o"],Mid:["\u0259"],"Open-mid":["\u025b","\u0153","\u025c","\u025e","\u028c","\u0254"],"Near-open":["\xe6","\u0250"],Open:["a","\u0276","\xe4","\u0251","\u0252"]},consonants:{Plosive:["p","b","t","d","\u0288","\u0256","c","\u025f","k","g","q","\u0262","\u0294","\u02a1"],Nasal:["m","\u0271","n","\u0273","\u0272","\u014b","\u0274"],Trill:["\u0299","r","\u0280"],"Tap/Flap":["\u2c71","\u027e","\u027d","\u027a"],Fricative:["\u0278","\u03b2","f","v","\u03b8","\xf0","s","z","\u0283","\u0292","\u0282","\u0290","\xe7","\u029d","x","\u0263","\u03c7","\u0281","\u0127","\u0295","\u029c","\u02a2","h","\u0266","\u0267"],"Lateral fricative":["\u026c","\u026e"],Approximant:["\u028b","\u0279","\u027b","j","\u0270","w","\u0265","\u028d"],"Lateral approximant":["l","\u026d","\u028e","\u029f","\u026b"],Clicks:["\u0298","\u01c0","\u01c3","\u01c2","\u01c1"],"Voiced implosives":["\u0253","\u0257","\u0284","\u0260","\u029b"],Ejectives:["p\u02bc","t\u02bc","k\u02bc","s\u02bc","q\u02bc","t\u0283\u02bc","ts\u02bc","t\u026c\u02bc","c\u02bc","\u0283\u02bc","x\u02bc","\u03c7\u02bc"]},diacritics:{Syllabicity:["\u0329","\u032f"],Release:["\u02b0","\u031a","\u207f","\u02e1","\u030a"],Phonation:["\u0325","\u032c","\u0324","\u0330","\u033c","\u030a"],Articulation:["\u032a","\u033a","\u033b","\u031f","\u0320","\u0308","\u033d","\u031d","\u031e","\u0318","\u0319","\u0339","\u031c"],"Co-articulation":["\u02b7","\u02b2","\u02e0","\u02e4","\u0334","\u0303","\u02de"],Timing:["\u0306","\u0304","\u02d0","\u02d1"]},suprasegmentals:{Stress:["\u02c8","\u02cc","\u02c8\u02c8"],Length:["\u02d0","\u02d1","\u0306"],Intonation:["|","\u2016",".","\u203f","\u2197","\u2198"],"Tone (Level)":["\u02e5","\u02e6","\u02e7","\u02e8","\u02e9"],"Tone (Contour)":["\u02e9\u02e5","\u02e5\u02e9","\u02e7\u02e5","\u02e9\u02e7","\u02e7\u02e9\u02e7","\u02e6\u02e5","\u02e7\u02e6","\u02e8\u02e7","\u02e9\u02e8"],"Tone (Diacritics)":["\u030b","\u0301","\u0304","\u0300","\u030f","\u030c","\u0302"],Prosody:["\u2191","\u2193","!","|","\u2016"]}};$("#vowels").html(t("vowels",f.vowels)),$("#consonants").html(t("consonants",f.consonants)),$("#diacritics").html(t("diacritics",f.diacritics)),$("#suprasegmentals").html(t("suprasegmentals",f.suprasegmentals)),$(document).on("click",".ipa-char-btn",function(){e($(this).data("char"))})});
